---
import ThemeToggle from './ThemeToggle.astro';
import { Menu } from '@lucide/astro';
import { XIcon as Close } from '@lucide/astro';

const isHomePage = Astro.url.pathname === '/';

const navLinks = [
  { href: '#about', label: 'About' },
  { href: '#skills', label: 'Skills' },
  { href: '/journey', label: 'Journey' },
  { href: '#experience', label: 'Experience' },
  { href: '#projects', label: 'Projects' },
  { href: '/blog', label: 'Blog' },
  { href: '#contact', label: 'Contact' },
];

// Prefix anchor links with "/" when not on home page
const getHref = (href: string) => {
  if (href.startsWith('#') && !isHomePage) {
    return '/' + href;
  }
  return href;
};
---

<header class="sticky top-0 z-50 bg-white/90 dark:bg-gray-950/90 backdrop-blur-sm border-b border-gray-200 dark:border-gray-800">
  <nav class="max-w-5xl mx-auto px-4 py-3 flex items-center justify-between">
    <!-- Logo -->
    <a href="/" class="font-bold text-xl tracking-tight hover:text-brand-600 dark:hover:text-brand-500 transition-colors">
      AS
    </a>

    <!-- Desktop Navigation -->
    <ul class="hidden md:flex items-center gap-6">
      {navLinks.map(link => (
        <li>
          <a
            href={getHref(link.href)}
            class="text-sm font-medium text-gray-600 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-100 transition-colors"
          >
            {link.label}
          </a>
        </li>
      ))}
    </ul>

    <div class="flex items-center gap-2">
      <ThemeToggle />

      <!-- Mobile Menu Toggle (CSS-only checkbox hack) -->
      <input
        type="checkbox"
        id="nav-toggle"
        class="hidden peer"
        aria-hidden="true"
      />
      <label
        for="nav-toggle"
        class="md:hidden p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800 cursor-pointer transition-colors"
        aria-label="Toggle navigation menu"
      >
        <Menu class="peer-checked:hidden" />
        <Close class="hidden peer-checked:block" />
      </label>
    </div>

    <!-- Mobile Menu Panel -->
    <div class="hidden peer-checked:flex fixed inset-x-0 top-14.25 bottom-0 bg-white dark:bg-gray-950 flex-col items-center justify-center gap-8 md:hidden z-40">
      {navLinks.map(link => (
        <a
          href={getHref(link.href)}
          class="text-xl font-medium text-gray-700 hover:text-brand-600 dark:text-gray-300 dark:hover:text-brand-500 transition-colors"
          onclick="document.getElementById('nav-toggle').checked = false"
        >
          {link.label}
        </a>
      ))}
    </div>
  </nav>
</header>

<style>
  /* Make the peer-checked work for sibling navigation */
  #nav-toggle:checked ~ div:last-child {
    display: flex;
  }
  #nav-toggle:checked + label svg:first-child {
    display: none;
  }
  #nav-toggle:checked + label svg:last-child {
    display: block;
  }
</style>
